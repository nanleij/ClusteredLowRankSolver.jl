<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solving · ClusteredLowRankSolver.jl Documentation</title><meta name="title" content="Solving · ClusteredLowRankSolver.jl Documentation"/><meta property="og:title" content="Solving · ClusteredLowRankSolver.jl Documentation"/><meta property="twitter:title" content="Solving · ClusteredLowRankSolver.jl Documentation"/><meta name="description" content="Documentation for ClusteredLowRankSolver.jl Documentation."/><meta property="og:description" content="Documentation for ClusteredLowRankSolver.jl Documentation."/><meta property="twitter:description" content="Documentation for ClusteredLowRankSolver.jl Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClusteredLowRankSolver.jl Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../advancedmodeling/">Advanced modeling</a></li><li class="is-active"><a class="tocitem" href>Solving</a><ul class="internal"><li><a class="tocitem" href="#Options"><span>Options</span></a></li><li><a class="tocitem" href="#Output"><span>Output</span></a></li><li><a class="tocitem" href="#Multithreading"><span>Multithreading</span></a></li></ul></li><li><a class="tocitem" href="../rounding/">Rounding</a></li><li><a class="tocitem" href="../sdpa/">SDPA-sparse format</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/delsarte/">Delsarte LP bound</a></li><li><a class="tocitem" href="../examples/sphere_packing/">Sphere packing</a></li><li><a class="tocitem" href="../examples/poly_opt/">Symmetric polynomial optimization</a></li><li><a class="tocitem" href="../examples/clustering/">Clustering</a></li><li><a class="tocitem" href="../examples/rounding/">Rounding the Delsarte LP bound</a></li></ul></li><li><a class="tocitem" href="../api/">API reference</a></li><li><a class="tocitem" href="../references/">References and citing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Solving</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solving</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nanleij/ClusteredLowRankSolver.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nanleij/ClusteredLowRankSolver.jl/blob/main/docs/src/solving.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="solver"><a class="docs-heading-anchor" href="#solver">The solver</a><a id="solver-1"></a><a class="docs-heading-anchor-permalink" href="#solver" title="Permalink"></a></h1><p><a href="https://github.com/nanleij/ClusteredLowRankSolver.jl"><code>ClusteredLowRankSolver.jl</code></a> implements a primal-dual interior-point method. That is, it solves both the primal and the dual problem. The problem given to the solver is considered to be in dual form. For more information on the primal-dual algorithm, see [<a href="../references/#de-laat-clustered-2022">2</a>] and [<a href="../references/#simmons-duffin-semidefinite-2015">3</a>].</p><p>A <a href="../tutorial/#ClusteredLowRankSolver.Problem"><code>Problem</code></a> can be solved using the function <a href="#ClusteredLowRankSolver.solvesdp"><code>solvesdp</code></a>. This first converts the problem to a <a href="../tutorial/#ClusteredLowRankSolver.ClusteredLowRankSDP"><code>ClusteredLowRankSDP</code></a>, after which it is solved using the algorithm.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClusteredLowRankSolver.solvesdp" href="#ClusteredLowRankSolver.solvesdp"><code>ClusteredLowRankSolver.solvesdp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">	solvesdp(problem::Problem; kwargs...)</code></pre><pre><code class="nohighlight hljs">    solvesdp(sdp::ClusteredLowRankSDP; kwargs...)</code></pre><p>Solve the semidefinite program generated from <code>problem</code> or <code>sdp</code>. </p><p>Keyword arguments:</p><ul><li><code>prec</code> (default: <code>precision(BigFloat)</code>): the precision used</li><li><code>gamma</code> (default: <code>0.9</code>): the step length reduction; a maximum step length of α reduces to a step length of <code>max(gamma*α,1)</code></li><li><code>beta_(in)feasible</code> (default: <code>0.1</code> (<code>0.3</code>)): the amount mu is tried to be reduced by in each iteration, for (in)feasible solutions</li><li><code>omega_p/d</code> (default: <code>10^10</code>): the starting matrix variable for the primal/dual is <code>omega_p/d*I</code></li><li><code>maxiterations</code> (default: <code>500</code>): the maximum number of iterations</li><li><code>duality_gap_threshold</code> (default: <code>10^-15</code>): how near to optimal the solution needs to be</li><li><code>primal/dual_error_threshold</code> (default:<code>10^-30</code>): how feasible the primal/dual solution needs to be</li><li><code>max_complementary_gap</code> (default: <code>10^100</code>): the maximum of <code>dot(X,Y)/nrows(X)</code> allowed</li><li><code>need_primal_feasible/need_dual_feasible</code> (default: <code>false</code>): terminate when the solution is primal/dual feasible</li><li><code>verbose</code> (default: <code>true</code>): print information after every iteration if true</li><li><code>step_length_threshold</code> (default: <code>10^-7</code>): the minimum step length allowed</li><li><code>primalsol</code> (default: <code>nothing</code>): start from the solution <code>(primalsol, dualsol)</code> if both <code>primalsol</code> and <code>dualsol</code> are given</li><li><code>dualsol</code> (default: <code>nothing</code>): start from the solution <code>(primalsol, dualsol)</code> if both <code>primalsol</code> and <code>dualsol</code> are given</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nanleij/ClusteredLowRankSolver.jl/blob/91e04d44dd33c22fc48ec5054f0d63fa16411588/src/solver.jl#L13-L36">source</a></section></article><h2 id="Options"><a class="docs-heading-anchor" href="#Options">Options</a><a id="Options-1"></a><a class="docs-heading-anchor-permalink" href="#Options" title="Permalink"></a></h2><p>Here we list the most important options. For the remaining options, see the documentation and the explanation of the algorithm in [<a href="../references/#simmons-duffin-semidefinite-2015">3</a>].</p><ul><li><code>prec</code> - The number of bits used for the calculations. The default is the <code>BigFloat</code> precision, which defaults to 256 bits.</li><li><code>duality_gap_threshold</code> - Gives an indication of how close the solution is to the optimal solution. As a rule of thumb, a duality gap of <span>$10^{-(k+1)}$</span> gives <span>$k$</span> correct digits.  Default: <span>$10^{-15}$</span></li><li><code>gamma</code> - The step length reduction; if a step of <span>$\alpha$</span> is possible, a step of <span>$\min(\gamma \alpha, 1)$</span> is taken. A lower <code>gamma</code> results in a more stable convergence, but can be significantly slower. Default: <span>$0.9$</span>.</li><li><code>omega_p</code>, <code>omega_d</code> - The size of the initial primal respectively dual solution. A low <code>omega</code> can keep the solver from converging, but a high <code>omega</code> in general increases the number of iterations needed and thus also the solving time. Default: <span>$10^{10}$</span></li><li><code>need_primal_feasible</code>, <code>need_dual_feasible</code> - If <code>true</code>, terminate when a primal or dual feasible solution is found, respectively. Default: <code>false</code>.</li><li><code>primal_error_threshold</code>, <code>dual_error_threshold</code> - The threshold below which the primal and dual error should be to be considered primal and dual feasible, respectively. Default: <span>$10^{-15}$</span>.</li></ul><h2 id="Output"><a class="docs-heading-anchor" href="#Output">Output</a><a id="Output-1"></a><a class="docs-heading-anchor-permalink" href="#Output" title="Permalink"></a></h2><p>When the option <code>verbose</code> is <code>true</code> (default), the solver will output information for every iteration. In order of output, we have (where the values are from the start of the iteration except for the step lengths, which are only known at the end of the iteration)</p><ul><li>The iteration number</li><li>The time since the start of the first iteration</li><li>The complementary gap <span>$\mu = \langle X, Y \rangle / K$</span> where <span>$K$</span> is the number of rows of <span>$X$</span>. Here <span>$X$</span> and <span>$Y$</span> denote the primal and dual solution matrices. The solution will converge to the optimum for <span>$\mu \to 0$</span>.</li><li>The primal objective</li><li>The dual objective</li><li>The relative duality gap </li><li>The primal matrix error </li><li>The primal scalar error </li><li>The dual (scalar) error </li><li>The primal step length</li><li>The dual step length</li><li><span>$\beta_c$</span>. The solver tries to reduce <span>$\mu$</span> by this factor in this iteration.</li></ul><p>An example of the output of the <a href="../examples/poly_opt/#expolyopt">Example</a> from polynomial optimization is</p><pre><code class="nohighlight hljs">iter  time(s)           μ       P-obj       D-obj        gap    P-error    p-error    d-error        α_p        α_d       beta
    1     11.9   1.000e+20   0.000e+00   0.000e+00   0.00e+00   1.00e+10   1.00e+00   1.95e+10   7.42e-01   7.10e-01   3.00e-01
    2     13.4   3.995e+19   1.999e+11  -2.907e+09   1.03e+00   2.58e+09   2.58e-01   5.65e+09   7.46e-01   7.17e-01   3.00e-01
    3     13.4   1.576e+19   3.079e+11  -4.779e+09   1.03e+00   6.53e+08   6.53e-02   1.60e+09   7.32e-01   7.31e-01   3.00e-01
...
   55     13.9   5.066e-14  -2.113e+00  -2.113e+00   8.39e-14   8.64e-78   2.59e-77   8.21e-73   1.00e+00   1.00e+00   1.00e-01
   56     13.9   5.067e-15  -2.113e+00  -2.113e+00   8.39e-15   8.64e-78   8.64e-78   8.39e-73   1.00e+00   1.00e+00   1.00e-01
Optimal solution found
 13.860834 seconds (13.74 M allocations: 913.073 MiB, 7.72% gc time, 93.09% compilation time)
 iter  time(s)           μ       P-obj       D-obj        gap    P-error    p-error    d-error        α_p        α_d       beta

Primal objective:-2.112913881423601867325289796075301826150007716044362101360781221096092533872562
Dual objective:-2.112913881423605414349991239275382883067580432169230529548206052006356176913883
Duality gap:8.393680245626824434313082297089851809408852609517159688543365552836941907249006e-16</code></pre><p>Note that the first iteration takes long because the functions used by the solver get compiled. The function <a href="#ClusteredLowRankSolver.solvesdp"><code>solvesdp</code></a> returns the status of the solutions, the primal and dual solutions, the solve time and an error code (see below).</p><h3 id="Status"><a class="docs-heading-anchor" href="#Status">Status</a><a id="Status-1"></a><a class="docs-heading-anchor-permalink" href="#Status" title="Permalink"></a></h3><p>When the algorithm finishes due to one of the termination criteria, the status, the final solution together with the objectives, the used time and an error code is returned. The status can be one of</p><ul><li><code>Optimal</code></li><li><code>NearOptimal</code> -  The solution is primal and dual feasible, and the duality gap is small (<span>$&lt;10^{-8}$</span>), although not smaller than <code>duality_gap_threshold</code>.</li><li><code>Feasible</code></li><li><code>PrimalFeasible</code> or <code>DualFeasible</code></li><li><code>NotConverged</code></li></ul><h3 id="Errors"><a class="docs-heading-anchor" href="#Errors">Errors</a><a id="Errors-1"></a><a class="docs-heading-anchor-permalink" href="#Errors" title="Permalink"></a></h3><p>Although unwanted, errors can be part of the output as well. The error codes give an indication what a possible solution could be to avoid the errors.</p><ol><li>No error</li><li>An arbitrary error. This can be an internal error such as a decomposition that was unsuccessful. If this occurs in the first iteration, it is a strong indication that the constraints are linearly dependent, e.g. due to using a set of sample points which is not minimal unisolvent for the basis used. Otherwise increasing the precision may help. This also includes errors which are due to external factors such as a keyboard interrupt.</li><li>The maximum number of iterations has been exceeded. Reasons include: slow convergence, a difficult problem. Possible solutions: increase the maximum number of iterations, increase <code>gamma</code> (if <code>gamma</code> is small), change the starting solution (<code>omega_p</code> and <code>omega_d</code>).</li><li>The maximum complementary gap (<span>$\mu$</span>) has been exceeded. Usually this indicates (primal and/or dual) infeasibility.</li><li>The step length is below the step length threshold. This indicates precision errors or a difficult problem. This may be solved by increasing the initial solutions (<code>omega_p</code> and <code>omega_d</code>), or by decreasing the step length reduction <code>gamma</code>, or by increasing the precision <code>prec</code>. If additionally the complementary gap is increasing, it might indicate (primal and/or dual) infeasibility.</li></ol><h2 id="Multithreading"><a class="docs-heading-anchor" href="#Multithreading">Multithreading</a><a id="Multithreading-1"></a><a class="docs-heading-anchor-permalink" href="#Multithreading" title="Permalink"></a></h2><p>The solver supports multithreading. This can be used by starting <code>julia</code> with</p><pre><code class="nohighlight hljs">julia -t n</code></pre><p>where <code>n</code> denotes the number of threads.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>On Windows, using multiple threads can lead to errors when using multiple clusters and free variables. This is probably related to Arb or the Julia interface to Arb.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../advancedmodeling/">« Advanced modeling</a><a class="docs-footer-nextpage" href="../rounding/">Rounding »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 8 August 2024 13:19">Thursday 8 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
