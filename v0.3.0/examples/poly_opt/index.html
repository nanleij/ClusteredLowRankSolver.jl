<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Symmetric polynomial optimization · ClusteredLowRankSolver.jl Documentation</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><script src="../../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ClusteredLowRankSolver.jl Documentation</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/interface/">Interface</a></li><li><a class="tocitem" href="../../manual/sampling_clustering/">Sampling and Clustering</a></li><li><a class="tocitem" href="../../manual/solver/">The solver</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../delsarte/">Delsarte LP bound</a></li><li><a class="tocitem" href="../sphere_packing/">Sphere packing</a></li><li class="is-active"><a class="tocitem" href>Symmetric polynomial optimization</a></li><li><a class="tocitem" href="../clustering/">Clustering</a></li></ul></li><li><a class="tocitem" href="../../references/">References and citing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Symmetric polynomial optimization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Symmetric polynomial optimization</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/nanleij/ClusteredLowRankSolver.jl/blob/master/docs/src/examples/poly_opt.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Multivariate-polynomial-optimization-using-symmetry-reduction"><a class="docs-heading-anchor" href="#Example:-Multivariate-polynomial-optimization-using-symmetry-reduction">Example: Multivariate polynomial optimization using symmetry reduction</a><a id="Example:-Multivariate-polynomial-optimization-using-symmetry-reduction-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Multivariate-polynomial-optimization-using-symmetry-reduction" title="Permalink"></a></h1><p>In this example, we consider minimizing a multivariate polynomial with <span>$S_3$</span> symmetries. The example is inspirated by example 7.1 from <a href="../../references/#gatermann-symmetry-2004">Karin Gatermann, Pablo A. Parrilo (2004)</a>. See the <a href="https://github.com/nanleij/ClusteredLowRankSolver.jl/tree/main/examples">Examples</a> folder for the file with the code. We consider the polynomial</p><p class="math-container">\[f(x,y,z) = x^4 + y^4 + z^4 - 4xyz + x + y + z\]</p><p>for which we want to find the minimum value <span>$f_{min} = \min_{x,y,z} f(x,y,z)$</span>. Relaxing the problem with a sum-of-squares constraint gives</p><p class="math-container">\[\begin{aligned}
    \max \quad&amp; M &amp;\\
    \text{s.t.} \quad&amp; f - M &amp;\text{is a sum-of-squares,}
\end{aligned}\]</p><p>where <span>$b$</span> is a vector of basis polynomials in variables <span>$x,y,z$</span> up to a certain degree <span>$d$</span>. Since the polynomial <span>$f$</span> is invariant under permuting the variables (i.e., the group action of <span>$S_3$</span>), it is natural to consider only invariant sum-of-squares polynomials. From <a href="../../references/#gatermann-symmetry-2004">Karin Gatermann, Pablo A. Parrilo (2004)</a>, we know that any sum-of-squares polynomial invariant under the action of <span>$S_3$</span> can be written as</p><p class="math-container">\[    \langle Y_1, ww^{\sf T} \rangle + \langle Y_2, \Pi_2 \otimes ww^{\sf T} \rangle + \langle Y_3, \Pi_3 \otimes ww^{\sf T} \rangle\]</p><p>where <span>$w(x,y,z)$</span> is a vector of basis polynomials of the invariant ring <span>$\R[x,y,z]^{S_3} = \R[x+y+z, xy+yz+xz, xyz]$</span>, and where <span>$\Pi_2(x,y,z) = ((x-y)(y-z)(z-x))^2$</span> and</p><p class="math-container">\[    \Pi_3 = \begin{pmatrix}2\phi_1^2-6\phi_2 &amp; -\phi_1\phi_2+9\phi_3 \\ -\phi_1\phi_2+9\phi_3 &amp; 2\phi_2^2- 6\phi_1\phi_3\end{pmatrix}.\]</p><p>In particular, <span>$\Pi_3$</span> is of rank 2 and has the decomposition <span>$v_1 v_1^{\sf T} + v_2 v_2^{\sf T}$</span> with</p><p class="math-container">\[v_1 = \frac{1}{\sqrt{2}}\begin{pmatrix}
    2x-y-z \\
    2yz-zx-xy
\end{pmatrix} \quad \text{ and } \quad v_2 = \sqrt{\frac{3}{2}}\begin{pmatrix}
    y-z \\
    zx-xy
\end{pmatrix}\]</p><p>Since we consider sum-of-squares polynomials of a certain degree <span>$d$</span>, we restrict to the elements of the matrices <span>$\Pi_i \otimes ww^{\sf T}$</span> with degree at most <span>$\lfloor d/2 \rfloor$</span>.</p><p>To sample this constraint we need a three-variate minimal unisolvent set for invariant polynomials of degree at most <span>$d$</span>. In this case, one such example are the representatives of the orbits of <span>$S_3$</span> of the rational points in the simplex with denominator <span>$d$</span>, since these points are invariant under <span>$S_3$</span> and are minimal unisolvent (see <a href="../../references/#de-laat-clustered-2022">David de Laat, Nando Leijenhorst (2022)</a>). However, if the polynomial space is more complicated it is unclear what a minimal unisolvent set is. To show one approach on this we instead make a grid of points which unisolvent but not minimal, and we use the approach of <a href="../../references/#de-laat-clustered-2022">David de Laat, Nando Leijenhorst (2022)</a> through <code>approximatefekete</code> to choose a good subset of these points and a corresponding good basis for <span>$w$</span>.</p><p>As for the example of the Delsarte bound, the objective is simply one free variable <span>$M$</span> with coefficient <span>$1$</span>. We also create a function to generate an invariant basis with variables <span>$x,y,z$</span>.</p><pre><code class="language-julia hljs">using ClusteredLowRankSolver, BasesAndSamples, AbstractAlgebra

function invariant_basis(x,y,z, d)
    # create a vector with a precise type
    v = [(x*y*z)^0]
    for deg=1:d, j=0:div(deg,3), i=0:div(deg-3j,2)
        # monomials in the invariant elementary polynomials
        # ordered by degree
        push!(v, (x+y+z)^(deg-2i-3j) * (x*y+y*z+z*x)^i * (x*y*z)^j)
    end
    return v
end

function min_f(d)

    obj = Objective(0, Dict(), Dict(:M =&gt; 1))</code></pre><p>In this case, we need a three-variate polynomial ring, and a basis of invariant polynomials. We also use <code>approximatefekete</code> to find a subset of the sample points with a good basis.</p><pre><code class="language-julia hljs">    FF = RealField
    R, (x,y,z) = PolynomialRing(FF, [&quot;x&quot;, &quot;y&quot;, &quot;z&quot;])
    # The polynomial f:
    f =  x^4 + y^4 + z^4 - 4x*y*z + x + y + z

    # An invariant basis up to degree d:
    basis = invariant_basis(x, y, z, 2d)
    # For the sum-of-squares polynomials we have to
    # select elements of the basis based on the degree
    degrees = [total_degree(p) for p in basis]

    # generate samples and a good basis
    cheb_points = [vcat(sample_points_chebyshev(2d+k)...) for k=0:2]
    samples_grid = [[cheb_points[1][i+1], cheb_points[2][j+1], cheb_points[3][k+1]]
        for i=0:2d for j=0:2d+1 for k=0:2d+2]
    basis, samples = approximatefekete(basis, samples_grid)</code></pre><p>Now we will construct the constraint matrices corresponding to the sum-of-squares parts. Although <code>approximatefekete</code> returns a polynomial basis only characterized by the evaluations on the sample points, we can work with it as if it were normal polynomials. Among others, this means that we can take the kronecker product of the sampled basis polynomials and a vector of polynomials.</p><pre><code class="language-julia hljs">    psd_dict = Dict()
    symmetry_weights = [[[R(1)]],
            [[R((x-y)*(y-z)*(z-x))]],
            [[1/sqrt(FF(2))*(2x-y-z),1/sqrt(FF(2))*(2y*z-x*z-x*y)],
                [sqrt(FF(3)/FF(2))*(y-z),sqrt(FF(3)/FF(2))*(x*z-x*y)]]]
    for swi=1:length(symmetry_weights)
        rank = length(symmetry_weights[swi])
        # create a decomposition of Π_i ⊗ ww^T in terms of polynomial vectors
        vecs = [kron(symmetry_weights[swi][r], basis) for r=1:rank]
        # This has in general too many entries,
        # so we will remove the ones with too high degree.
        for r=1:rank
            len = length(basis)
            # we keep the elements with degree at most d.
            keep_idx = [i for i=1:length(vecs[r])
                if total_degree(symmetry_weights[swi][r][div(i-1,len)+1]) +
                    degrees[(i-1)%len+1] &lt;= d]
            vecs[r] = vecs[r][keep_idx]
        end
        psd_dict[Block((:trivariatesos,swi))] =
                LowRankMatPol([R(1) for r=1:rank], vecs)
    end</code></pre><p>Now we can formulate the constraint and solve the <code>ClusteredLowRankSDP</code>:</p><pre><code class="language-julia hljs">    # the constraint is SOS + M = f
    constr = Constraint(f, psd_dict, Dict(:M =&gt; R(1)), samples)
    pol_problem = LowRankPolProblem(true, obj, [constr])
    sdp = ClusteredLowRankSDP(pol_problem)

    solvesdp(sdp)
end</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sphere_packing/">« Sphere packing</a><a class="docs-footer-nextpage" href="../clustering/">Clustering »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Thursday 25 May 2023 14:52">Thursday 25 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
