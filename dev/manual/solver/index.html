<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The solver · ClusteredLowRankSolver.jl Documentation</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><script src="../../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ClusteredLowRankSolver.jl Documentation</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../interface/">Interface</a></li><li><a class="tocitem" href="../sampling_clustering/">Sampling and Clustering</a></li><li class="is-active"><a class="tocitem" href>The solver</a><ul class="internal"><li><a class="tocitem" href="#Options"><span>Options</span></a></li><li><a class="tocitem" href="#Output"><span>Output</span></a></li><li><a class="tocitem" href="#Multithreading"><span>Multithreading</span></a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/delsarte/">Delsarte LP bound</a></li><li><a class="tocitem" href="../../examples/sphere_packing/">Sphere packing</a></li><li><a class="tocitem" href="../../examples/poly_opt/">Symmetric polynomial optimization</a></li><li><a class="tocitem" href="../../examples/clustering/">Clustering</a></li></ul></li><li><a class="tocitem" href="../../references/">References and citing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>The solver</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>The solver</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/nanleij/ClusteredLowRankSolver.jl/blob/master/docs/src/manual/solver.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-solver"><a class="docs-heading-anchor" href="#The-solver">The solver</a><a id="The-solver-1"></a><a class="docs-heading-anchor-permalink" href="#The-solver" title="Permalink"></a></h1><p><code>ClusteredLowRankSolver</code> is a primal-dual interior point method. Besides the dual program, it simultaneously solves the primal program</p><p class="math-container">\[\begin{aligned}
  \max &amp; \sum_{j=1}^J \langle c^j, x^j \rangle &amp;\\
  \text{s.t.} &amp; \sum_{j=1}^J (B^j)^{\sf T} x^j = b &amp;\\
   &amp; X^{j}= \sum_{p=1}^{P_j} x_p^j A_p^{j} - C^{j} \succeq 0,\quad &amp;j=1,\ldots,J.
\end{aligned}\]</p><p>Starting from a (probably infeasible) solution, the solver iteratively improves the solution using Newton steps until it is sufficiently close to being feasible and optimal. For a discussion of the general algorithm, see <a href="../../references/#simmons-duffin-semidefinite-2015">David Simmons-Duffin (2015)</a>; for the modifications needed to be able to use the general low-rank structures and for a discussion of the parallelization strategy, see <a href="../../references/#de-laat-clustered-2022">David de Laat, Nando Leijenhorst (2022)</a>. The feasibility is measured by the violation of the primal and dual constraints given by</p><p class="math-container">\[\begin{aligned}
    p &amp;= \sum_{j=1}^J (B^j)^{\sf T} x^j - b, \\
    P^j &amp;= X^{j} - \sum_{p=1}^{P_j} x_p^j A_p^{j} + C^{j}, \\
    d^j &amp;= \big\langle A_*^{j}, Y^{j}\big\rangle + B^jy - c^j.
\end{aligned}\]</p><p>We denote the primal and dual errors by</p><p class="math-container">\[  ε_p = \max(\max_{r}( |p_r|), \max_{j,r,s}(|P^j_{rs}|))\]</p><p>and</p><p class="math-container">\[    ε_d = \max_{j,r}( |d^j_r|),\]</p><p>respectively. A solution <span>$(x,X,y,Y)$</span> is primal (dual) feasible if the primal (dual) error is at most the threshold <code>primal_error_threshold</code> (<code>dual_error_threshold</code>). A solution is feasible if it is both primal and dual feasible.</p><p>Denoting the primal objective by <span>$O_p(x,X)$</span> and the dual objective by <span>$O_d(y,Y)$</span>, a measure of optimality is given by the (normalized) duality gap</p><p class="math-container">\[    Δ = \frac{|O_p(x,X) - O_d(y,Y)|}{\max(1,|O_p(x,X) + O_d(y,Y) |)}.\]</p><p>which measures the relative difference between the objectives of the primal and the dual problem. A solution is considered optimal if it is feasible and if the duality gap is at most <code>duality_gap_threshold</code>. The solver iteratively improves the feasibility and the duality gap of the solution.</p><h2 id="Options"><a class="docs-heading-anchor" href="#Options">Options</a><a id="Options-1"></a><a class="docs-heading-anchor-permalink" href="#Options" title="Permalink"></a></h2><p>Here we list the most important options. For the remaining options, see the documentation and the explanation of the algorithm in <a href="../../references/#simmons-duffin-semidefinite-2015">David Simmons-Duffin (2015)</a>.</p><ul><li><code>prec</code> - The number of bits used for the calculations. The default is the <code>BigFloat</code> precision, which defaults to 256 bits.</li><li><code>duality_gap_threshold</code> - Gives an indication of how close the solution is to the optimal solution. As a rule of thumb, a duality gap of <span>$10^{-(k+1)}$</span> gives <span>$k$</span> correct digits.  Default: <span>$10^{-15}$</span></li><li><code>gamma</code> - The step length reduction; if a step of <span>$\alpha$</span> is possible, a step of <span>$\min(\gamma \alpha, 1)$</span> is taken. A lower <code>gamma</code> results in a more stable convergence, but can be significantly slower. Default: <span>$0.9$</span>.</li><li><code>omega_p</code>, <code>omega_d</code> - The size of the initial primal respectively dual solution. A low <code>omega</code> can keep the solver from converging, but a high <code>omega</code> in general increases the number of iterations needed and thus also the solving time. Default: <span>$10^{10}$</span></li><li><code>need_primal_feasible</code>, <code>need_dual_feasible</code> - If <code>true</code>, terminate when a primal or dual feasible solution is found, respectively. Default: <code>false</code>.</li></ul><h2 id="Output"><a class="docs-heading-anchor" href="#Output">Output</a><a id="Output-1"></a><a class="docs-heading-anchor-permalink" href="#Output" title="Permalink"></a></h2><p>When the option <code>verbose</code> is <code>true</code> (default), the solver will output information for every iteration. In order of output, we have (where the values are from the start of the iteration except for the step lengths, which are only known at the end of the iteration)</p><ul><li>The iteration number</li><li>The time since the start of the first iteration</li><li>The complementary gap <span>$\mu = \langle X, Y \rangle / K$</span> where <span>$K$</span> is the number of rows of <span>$X$</span>. The solution will converge to the optimum for <span>$\mu \to 0$</span>.</li><li>The primal objective <span>$O_p(y,Y)$</span></li><li>The dual objective <span>$O_d(y,Y)$</span></li><li>The relative duality gap <span>$Δ$</span></li><li>The primal matrix error <span>$\max_{j,r,s}|P^j_{rs}|$</span>.</li><li>The primal scalar error <span>$\max_{r}|p_r|$</span></li><li>The dual (scalar) error <span>$ε_d$</span></li><li>The primal step length</li><li>The dual step length</li><li><span>$\beta_c$</span>. The solver tries to reduce <span>$\mu$</span> by this factor in this iteration.</li></ul><p>An example of the output of the example used to explain the interface is</p><pre><code class="nohighlight hljs">iter  time(s)           μ       P-obj       D-obj        gap    P-error    p-error    d-error        α_p        α_d       beta
   1     12.8   1.000e+20   0.000e+00   0.000e+00   0.00e+00   1.00e+10   1.00e+00   6.43e+09   7.51e-01   7.58e-01   3.00e-01
   2     13.2   3.547e+19   3.624e+10  -9.588e+08   1.05e+00   2.49e+09   2.49e-01   1.56e+09   6.97e-01   7.05e-01   3.00e-01
...
  60     13.8   1.216e-14  -2.113e+00  -2.113e+00   2.88e-14   4.53e-76   1.71e-75   8.94e-71   1.00e+00   1.00e+00   1.00e-01
  61     13.8   1.216e-15  -2.113e+00  -2.113e+00   2.88e-15   5.53e-76   7.65e-75   1.67e-70   1.00e+00   1.00e+00   1.00e-01
Optimal solution found
13.806709 seconds (31.85 M allocations: 1.724 GiB, 8.04% gc time, 95.01% compilation time)
iter  time(s)           μ       P-obj       D-obj        gap    P-error    p-error    d-error        α_p        α_d       beta

Primal objective:[-2.1129138814236035493303617046125433190930634590630701102555586784046703753 +/- 8.99e-74]
Primal objective:[-2.1129138814236047658789644991030406911852260781814341016229113808001230237954 +/- 3.25e-77]
Duality gap:[2.878840953931412734986211198407702873449111279309426433372e-16 +/- 2.66e-74]</code></pre><p>Note that the first iteration takes long because the functions used by the solver get compiled.</p><h3 id="Status"><a class="docs-heading-anchor" href="#Status">Status</a><a id="Status-1"></a><a class="docs-heading-anchor-permalink" href="#Status" title="Permalink"></a></h3><p>When the algorithm finishes due to one of the termination criteria, the status, the final solution together with the objectives, the used time and an error code is returned. The status can be one of</p><ul><li><code>Optimal</code></li><li><code>NearOptimal</code> -   The solution is primal and dual feasible, and the duality gap is small (<span>$&lt;10^{-8}$</span>), although not smaller than <code>duality_gap_threshold</code>.</li><li><code>Feasible</code></li><li><code>PrimalFeasible</code> or <code>DualFeasible</code></li><li><code>NotConverged</code></li></ul><p>The final solution is stored in the <code>CLRSResults</code> structure. This includes the variables <span>$(x,X,y,Y)$</span>, the primal and dual objective, and the self-chosen names corresponding to the variables <span>$Y$</span> and <span>$y$</span>.</p><h3 id="Errors"><a class="docs-heading-anchor" href="#Errors">Errors</a><a id="Errors-1"></a><a class="docs-heading-anchor-permalink" href="#Errors" title="Permalink"></a></h3><p>Although unwanted, errors can be part of the output as well. The error codes give an indication what a possible solution could be to avoid the errors.</p><ol><li>No error</li><li>An arbitrary error. This can be an internal error such as a decomposition that was unsuccessful. If this occurs in the first iteration, it is a strong indication that the constraints are linearly dependent, e.g. due to using a set of sample points which is not minimal unisolvent for the basis used. Otherwise increasing the precision may help. This also includes errors which are due to external factors such as a keyboard interrupt.</li><li>The maximum number of iterations has been exceeded. Reasons include: slow convergence, a difficult problem. Possible solutions: increase the maximum number of iterations, increase <code>gamma</code> (if <code>gamma</code> is small), change the starting solution (<code>omega_p</code> and <code>omega_d</code>).</li><li>The maximum complementary gap (<span>$\mu$</span>) has been exceeded. Usually this indicates (primal and/or dual) infeasibility.</li><li>The step length is below the step length threshold. This indicates precision errors or a difficult problem. This may be solved by increasing the initial solutions (<code>omega_p</code> and <code>omega_d</code>), or by decreasing the step length reduction <code>gamma</code>, or by increasing the precision <code>prec</code>.</li></ol><h2 id="Multithreading"><a class="docs-heading-anchor" href="#Multithreading">Multithreading</a><a id="Multithreading-1"></a><a class="docs-heading-anchor-permalink" href="#Multithreading" title="Permalink"></a></h2><p>The solver supports multithreading. This can be used by starting <code>julia</code> with</p><pre><code class="language-julia hljs">julia -t n</code></pre><p>where <code>n</code> denotes the number of threads.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>On Windows, using multiple threads can lead to errors when using multiple clusters and free variables. This is probably related to Arb or the Julia interface to Arb.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling_clustering/">« Sampling and Clustering</a><a class="docs-footer-nextpage" href="../../examples/delsarte/">Delsarte LP bound »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Thursday 25 May 2023 08:10">Thursday 25 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
