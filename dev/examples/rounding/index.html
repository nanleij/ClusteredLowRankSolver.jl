<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rounding the Delsarte LP bound · ClusteredLowRankSolver.jl Documentation</title><meta name="title" content="Rounding the Delsarte LP bound · ClusteredLowRankSolver.jl Documentation"/><meta property="og:title" content="Rounding the Delsarte LP bound · ClusteredLowRankSolver.jl Documentation"/><meta property="twitter:title" content="Rounding the Delsarte LP bound · ClusteredLowRankSolver.jl Documentation"/><meta name="description" content="Documentation for ClusteredLowRankSolver.jl Documentation."/><meta property="og:description" content="Documentation for ClusteredLowRankSolver.jl Documentation."/><meta property="twitter:description" content="Documentation for ClusteredLowRankSolver.jl Documentation."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ClusteredLowRankSolver.jl Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../advancedmodeling/">Advanced modeling</a></li><li><a class="tocitem" href="../../solving/">Solving</a></li><li><a class="tocitem" href="../../saving/">Saving</a></li><li><a class="tocitem" href="../../rounding/">Rounding</a></li><li><a class="tocitem" href="../../sdpa/">SDPA-sparse format</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../delsarte/">Delsarte LP bound</a></li><li><a class="tocitem" href="../sphere_packing/">Sphere packing</a></li><li><a class="tocitem" href="../poly_opt/">Symmetric polynomial optimization</a></li><li><a class="tocitem" href="../clustering/">Clustering</a></li><li class="is-active"><a class="tocitem" href>Rounding the Delsarte LP bound</a><ul class="internal"><li><a class="tocitem" href="#Using-coefficient-matching"><span>Using coefficient matching</span></a></li><li><a class="tocitem" href="#Getting-an-exact-feasible-solution-close-to-the-optimum"><span>Getting an exact feasible solution close to the optimum</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../references/">References and citing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Rounding the Delsarte LP bound</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Rounding the Delsarte LP bound</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nanleij/ClusteredLowRankSolver.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nanleij/ClusteredLowRankSolver.jl/blob/main/docs/src/examples/rounding.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="exrounding"><a class="docs-heading-anchor" href="#exrounding">Example: Rounding the Delsarte LP bound</a><a id="exrounding-1"></a><a class="docs-heading-anchor-permalink" href="#exrounding" title="Permalink"></a></h1><p>For this example, we slightly modify the code of the <a href="../delsarte/#exdelsarte">Delsarte</a> bound to define an exact problem.</p><pre><code class="language-julia hljs">using ClusteredLowRankSolver, Nemo

function delsarte_exact(n, d, costheta; FF=QQ, g=1, eps=1e-40)
    constraints = []

    P, x = polynomial_ring(FF, :x)

    gbasis = basis_gegenbauer(2d, n, x)
    sosbasis = basis_chebyshev(2d, x)

    samples = sample_points_chebyshev(2d)
    # round the samples to QQ:
    samples = [round(BigInt, x * 10^4)//10^4 for x in samples]

    c = Dict()
    for k = 0:2d
        c[k] = [gbasis[k+1];;]
    end
    c[:A] = LowRankMatPol([1], [sosbasis[1:d+1]])
    c[:B] = LowRankMatPol([(x+1)*(costheta-x)], [sosbasis[1:d]])
    push!(constraints, Constraint(-1, c, Dict(), samples))

    objective = Objective(1, Dict(k =&gt; [1;;] for k=0:2d), Dict())

    problem = Problem(Minimize(objective), constraints)

    problem_bigfloat = map(x-&gt;generic_embedding(x, g), problem)
    status, dualsol, primalsol, time, errorcode = solvesdp(problem_bigfloat, duality_gap_threshold=eps)

    return objvalue(problem, primalsol), problem, dualsol, primalsol
end</code></pre><p>Here we made a few modifications. </p><ul><li>We defined the polynomial ring over the field <code>FF</code>, so that the problem becomes exact.</li><li>We also made the samples exact rational numbers. This is in this case not strictly necessary if we use coefficient matching for the rounding procedure, but it is necessary when evaluating polynomials on these samples.</li><li>We added the line<pre><code class="language-julia hljs">    problem_bigfloat = map(x-&gt;generic_embedding(x, g), problem)</code></pre>This embeds the field in <span>$\mathbb{R}$</span> using the floating point approximation <code>g</code> of the generator of the field we use. The exact problem cannot be solved with the solver if we use a number field with a generator, since it is unclear which generator of the field we meant when building the problem.</li><li>We now return the problem and the primal and dual solution too. </li></ul><p>One example where the delsarte bound is sharp, is when considering a code with <span>$\cos\theta = 1/(\sqrt{5} - 1)$</span> in <span>$\mathbb{R}^4$</span>. The optimal spherical code then has <span>$120$</span> points. To round the solution, we first define the field using the minimal polynomial <span>$x^2 - 5 = 0$</span>.</p><pre><code class="language-julia hljs">R, x = polynomial_ring(QQ, :x)
N, z = number_field(x^2 - 5, :z)
gapprox = sqrt(big(5))</code></pre><p>Then we can call the rounding procedure:</p><pre><code class="language-julia hljs">n = 4
d = 9
costheta = 1/(z-1)
# find an approximate solution
obj, problem, dualsol, primalsol = delsarte_exact(n, d, costheta; FF=N, g = gapprox)
# round the approximate solution to an exact solution
success, exactprimalsol = exact_solution(problem, dualsol, primalsol; FF=N, g=gapprox)
objexact = objvalue(problem, exactprimalsol)
(success, objexact)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(true, 120)</code></pre><p>When the problem is not defined over the same field as the solution, we can find the field using</p><pre><code class="language-julia hljs">N2, gapprox2 = find_field(dualsol, primalsol)
defining_polynomial(N2), gapprox2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(x^2 + x - 1, -1.61803398874989484820458683436563811772030917980576286213544862270526046281891)</code></pre><p>which returns the field with defining polynomial <span>$x^2 + x - 1 = 0$</span> and approximate generator <span>$-1.618033... \approx (-1 -\sqrt{5})/2$</span>.</p><h2 id="Using-coefficient-matching"><a class="docs-heading-anchor" href="#Using-coefficient-matching">Using coefficient matching</a><a id="Using-coefficient-matching-1"></a><a class="docs-heading-anchor-permalink" href="#Using-coefficient-matching" title="Permalink"></a></h2><p>As mentioned in the section about <a href="../../rounding/#secrounding">Rounding</a>, using coefficient matching will often result in a solution of smaller bit size. To do that in this example, one can use</p><pre><code class="language-julia hljs">obj, problem, dualsol, primalsol = delsarte_exact(n, d, costheta; FF=N, g = gapprox)
R, x = polynomial_ring(N, :x)
mon_basis = [x^k for k=0:2d]
success, exactprimalsol_smaller = exact_solution(problem, dualsol, primalsol, FF=N, g=gapprox, monomial_bases = [mon_basis])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> iter  time(s)           μ       D-obj       P-obj        gap    D-error    d-error    p-error        α_d        α_p       beta
    1      0.1   1.000e+20   1.000e+00   1.900e+11   1.00e+00   1.00e+10   0.00e+00   2.18e+11   3.69e-01   5.95e-01   3.00e-01
    2      0.1   6.494e+19   1.223e+10   1.739e+11   8.69e-01   6.31e+09   0.00e+00   8.84e+10   7.31e-01   6.03e-01   3.00e-01
    3      0.1   2.817e+19   3.102e+10   2.208e+11   7.54e-01   1.70e+09   0.00e+00   3.51e+10   6.85e-01   7.10e-01   3.00e-01
    4      0.1   1.230e+19   3.546e+10   3.600e+11   8.21e-01   5.34e+08   0.00e+00   1.02e+10   5.57e-01   1.00e+00   3.00e-01
    5      0.1   8.216e+18   2.178e+10   8.065e+11   9.47e-01   2.37e+08   0.00e+00   4.83e-65   7.69e-01   1.00e+00   3.00e-01
    6      0.2   3.035e+18   5.560e+09   1.290e+12   9.91e-01   5.47e+07   0.00e+00   2.80e-64   8.01e-01   1.00e+00   3.00e-01
    7      0.2   9.665e+17   1.150e+09   2.064e+12   9.99e-01   1.09e+07   0.00e+00   1.49e-63   8.65e-01   1.00e+00   3.00e-01
    8      0.2   2.092e+17   1.573e+08   3.302e+12   1.00e+00   1.47e+06   0.00e+00   2.29e-63   8.98e-01   1.00e+00   3.00e-01
    9      0.2   3.428e+16   1.603e+07   5.284e+12   1.00e+00   1.51e+05   0.00e+00   2.01e-63   8.88e-01   1.00e+00   3.00e-01
   10      0.2   6.127e+15   1.797e+06   8.453e+12   1.00e+00   1.68e+04   0.00e+00   7.08e-63   8.99e-01   1.00e+00   3.00e-01
   11      0.3   9.935e+14   1.816e+05   1.352e+13   1.00e+00   1.71e+03   0.00e+00   2.00e-63   8.93e-01   1.00e+00   3.00e-01
   12      0.3   1.699e+14   1.946e+04   2.163e+13   1.00e+00   1.82e+02   0.00e+00   8.43e-63   9.00e-01   1.00e+00   3.00e-01
   13      0.3   2.794e+13   2.009e+03   3.442e+13   1.00e+00   1.82e+01   0.00e+00   3.35e-62   8.98e-01   1.00e+00   3.00e-01
   14      0.3   5.597e+12   2.662e+02   5.231e+13   1.00e+00   1.86e+00   0.00e+00   9.67e-63   8.79e-01   1.00e+00   3.00e-01
   15      0.3   2.030e+12   9.171e+01   5.562e+13   1.00e+00   2.25e-01   0.00e+00   9.24e-63   7.97e-01   1.00e+00   3.00e-01
   16      0.4   7.056e+11   7.350e+01   2.417e+13   1.00e+00   4.58e-02   0.00e+00   3.82e-63   8.24e-01   1.00e+00   3.00e-01
   17      0.4   2.136e+11   7.073e+01   7.703e+12   1.00e+00   8.06e-03   0.00e+00   8.06e-63   1.00e+00   1.00e+00   3.00e-01
   18      0.4   6.305e+10   6.979e+01   2.396e+12   1.00e+00   5.53e-76   0.00e+00   3.82e-62   1.00e+00   1.00e+00   3.00e-01
   19      0.8   1.891e+10   6.985e+01   7.188e+11   1.00e+00   5.53e-76   0.00e+00   9.55e-62   9.94e-01   9.94e-01   1.00e-01
   20      0.8   1.996e+09   6.986e+01   7.583e+10   1.00e+00   1.11e-75   0.00e+00   8.39e-64   1.00e+00   1.00e+00   1.00e-01
   21      0.8   2.003e+08   6.986e+01   7.613e+09   1.00e+00   5.53e-76   0.00e+00   6.13e-64   1.00e+00   1.00e+00   1.00e-01
   22      0.8   2.005e+07   6.987e+01   7.619e+08   1.00e+00   1.11e-75   0.00e+00   3.97e-65   1.00e+00   1.00e+00   1.00e-01
   23      0.9   2.005e+06   6.987e+01   7.619e+07   1.00e+00   1.11e-75   0.00e+00   2.67e-67   1.00e+00   1.00e+00   1.00e-01
   24      0.9   2.005e+05   6.988e+01   7.620e+06   1.00e+00   1.11e-75   0.00e+00   2.10e-67   1.00e+00   1.00e+00   1.00e-01
   25      0.9   2.006e+04   6.988e+01   7.622e+05   1.00e+00   2.21e-75   0.00e+00   1.17e-68   1.00e+00   1.00e+00   1.00e-01
   26      0.9   2.007e+03   6.989e+01   7.635e+04   9.98e-01   1.11e-75   0.00e+00   9.98e-70   9.99e-01   9.99e-01   1.00e-01
   27      0.9   2.026e+02   6.998e+01   7.768e+03   9.82e-01   5.53e-76   0.00e+00   1.05e-70   9.90e-01   9.90e-01   1.00e-01
   28      1.0   2.205e+01   7.086e+01   9.087e+02   8.55e-01   1.11e-75   0.00e+00   1.77e-70   9.26e-01   9.26e-01   1.00e-01
   29      1.0   3.666e+00   7.788e+01   2.172e+02   4.72e-01   1.11e-75   0.00e+00   1.19e-70   8.10e-01   8.10e-01   1.00e-01
   30      1.0   9.925e-01   1.015e+02   1.392e+02   1.57e-01   2.21e-75   0.00e+00   5.77e-71   6.72e-01   6.72e-01   1.00e-01
   31      1.0   3.920e-01   1.120e+02   1.269e+02   6.23e-02   1.11e-75   0.00e+00   1.09e-70   8.04e-01   8.04e-01   1.00e-01
   32      1.0   1.082e-01   1.179e+02   1.220e+02   1.71e-02   1.11e-75   0.00e+00   1.80e-71   8.72e-01   8.72e-01   1.00e-01
   33      1.1   2.330e-02   1.195e+02   1.204e+02   3.69e-03   1.11e-75   0.00e+00   7.14e-71   9.67e-01   9.67e-01   1.00e-01
   34      1.1   3.027e-03   1.199e+02   1.201e+02   4.79e-04   5.53e-76   0.00e+00   1.23e-70   9.83e-01   9.83e-01   1.00e-01
   35      1.1   3.477e-04   1.200e+02   1.200e+02   5.51e-05   1.11e-75   0.00e+00   4.82e-71   9.94e-01   9.94e-01   1.00e-01
   36      1.1   3.680e-05   1.200e+02   1.200e+02   5.83e-06   1.11e-75   0.00e+00   6.24e-71   9.99e-01   9.99e-01   1.00e-01
   37      1.1   3.724e-06   1.200e+02   1.200e+02   5.90e-07   5.53e-76   0.00e+00   1.48e-71   1.00e+00   1.00e+00   1.00e-01
   38      1.2   3.730e-07   1.200e+02   1.200e+02   5.91e-08   2.21e-75   0.00e+00   8.93e-71   1.00e+00   1.00e+00   1.00e-01
   39      1.2   3.731e-08   1.200e+02   1.200e+02   5.91e-09   2.21e-75   0.00e+00   4.44e-71   1.00e+00   1.00e+00   1.00e-01
   40      1.2   3.732e-09   1.200e+02   1.200e+02   5.91e-10   5.53e-76   0.00e+00   6.47e-72   1.00e+00   1.00e+00   1.00e-01
   41      1.2   3.732e-10   1.200e+02   1.200e+02   5.91e-11   1.11e-75   0.00e+00   1.19e-71   1.00e+00   1.00e+00   1.00e-01
   42      1.2   3.733e-11   1.200e+02   1.200e+02   5.91e-12   2.21e-75   0.00e+00   3.85e-71   1.00e+00   1.00e+00   1.00e-01
   43      1.3   3.733e-12   1.200e+02   1.200e+02   5.91e-13   1.11e-75   0.00e+00   1.65e-71   1.00e+00   1.00e+00   1.00e-01
   44      1.3   3.733e-13   1.200e+02   1.200e+02   5.91e-14   1.11e-75   0.00e+00   3.41e-71   1.00e+00   1.00e+00   1.00e-01
   45      1.3   3.734e-14   1.200e+02   1.200e+02   5.91e-15   1.11e-75   0.00e+00   1.30e-70   1.00e+00   1.00e+00   1.00e-01
   46      1.3   3.734e-15   1.200e+02   1.200e+02   5.91e-16   5.53e-76   0.00e+00   8.97e-71   1.00e+00   1.00e+00   1.00e-01
   47      1.3   3.735e-16   1.200e+02   1.200e+02   5.91e-17   1.11e-75   0.00e+00   7.69e-70   1.00e+00   1.00e+00   1.00e-01
   48      1.4   3.735e-17   1.200e+02   1.200e+02   5.91e-18   5.53e-76   0.00e+00   1.49e-69   1.00e+00   1.00e+00   1.00e-01
   49      1.4   3.735e-18   1.200e+02   1.200e+02   5.91e-19   5.53e-76   0.00e+00   2.10e-69   1.00e+00   1.00e+00   1.00e-01
   50      1.4   3.736e-19   1.200e+02   1.200e+02   5.91e-20   1.11e-75   0.00e+00   9.49e-69   1.00e+00   1.00e+00   1.00e-01
   51      1.4   3.736e-20   1.200e+02   1.200e+02   5.92e-21   1.11e-75   0.00e+00   1.64e-68   1.00e+00   1.00e+00   1.00e-01
   52      1.4   3.736e-21   1.200e+02   1.200e+02   5.92e-22   1.11e-75   0.00e+00   2.24e-68   1.00e+00   1.00e+00   1.00e-01
   53      1.5   3.737e-22   1.200e+02   1.200e+02   5.92e-23   1.11e-75   0.00e+00   5.16e-69   1.00e+00   1.00e+00   1.00e-01
   54      1.5   3.737e-23   1.200e+02   1.200e+02   5.92e-24   1.11e-75   0.00e+00   7.26e-68   1.00e+00   1.00e+00   1.00e-01
   55      1.5   3.738e-24   1.200e+02   1.200e+02   5.92e-25   2.21e-75   0.00e+00   1.74e-68   1.00e+00   1.00e+00   1.00e-01
   56      1.5   3.738e-25   1.200e+02   1.200e+02   5.92e-26   1.11e-75   0.00e+00   1.21e-67   1.00e+00   1.00e+00   1.00e-01
   57      1.5   3.738e-26   1.200e+02   1.200e+02   5.92e-27   1.11e-75   0.00e+00   1.26e-66   1.00e+00   1.00e+00   1.00e-01
   58      1.6   3.739e-27   1.200e+02   1.200e+02   5.92e-28   1.11e-75   0.00e+00   1.89e-66   1.00e+00   1.00e+00   1.00e-01
   59      1.6   3.739e-28   1.200e+02   1.200e+02   5.92e-29   1.11e-75   0.00e+00   1.39e-66   1.00e+00   1.00e+00   1.00e-01
   60      1.9   3.739e-29   1.200e+02   1.200e+02   5.92e-30   1.11e-75   0.00e+00   1.42e-66   1.00e+00   1.00e+00   1.00e-01
   61      2.0   3.740e-30   1.200e+02   1.200e+02   5.92e-31   1.11e-75   0.00e+00   5.34e-66   1.00e+00   1.00e+00   1.00e-01
   62      2.0   3.740e-31   1.200e+02   1.200e+02   5.92e-32   1.11e-75   0.00e+00   2.85e-66   1.00e+00   1.00e+00   1.00e-01
   63      2.0   3.741e-32   1.200e+02   1.200e+02   5.92e-33   1.11e-75   0.00e+00   5.07e-65   1.00e+00   1.00e+00   1.00e-01
   64      2.0   3.741e-33   1.200e+02   1.200e+02   5.92e-34   1.11e-75   0.00e+00   9.17e-65   1.00e+00   1.00e+00   1.00e-01
   65      2.0   3.741e-34   1.200e+02   1.200e+02   5.92e-35   1.11e-75   0.00e+00   8.69e-65   1.00e+00   1.00e+00   1.00e-01
   66      2.1   3.742e-35   1.200e+02   1.200e+02   5.92e-36   1.11e-75   0.00e+00   5.99e-65   1.00e+00   1.00e+00   1.00e-01
   67      2.1   3.742e-36   1.200e+02   1.200e+02   5.92e-37   1.11e-75   0.00e+00   8.01e-64   1.00e+00   1.00e+00   1.00e-01
   68      2.1   3.742e-37   1.200e+02   1.200e+02   5.93e-38   5.53e-76   0.00e+00   6.17e-64   1.00e+00   1.00e+00   1.00e-01
   69      2.1   3.743e-38   1.200e+02   1.200e+02   5.93e-39   1.11e-75   0.00e+00   1.54e-63   1.00e+00   1.00e+00   1.00e-01
   70      2.1   3.743e-39   1.200e+02   1.200e+02   5.93e-40   1.11e-75   0.00e+00   1.48e-63   1.00e+00   1.00e+00   1.00e-01
Optimal solution found
  2.131847 seconds (7.93 M allocations: 461.726 MiB, 49.72% gc time)
 iter  time(s)           μ       D-obj       P-obj        gap    D-error    d-error    p-error        α_d        α_p       beta

Primal objective:120.0000000000000000000000000000000000000059895918902114120736224500749988768008
Dual objective:119.9999999999999999999999999999999999999917643111509593083987691311468765499283
duality gap:5.92720030802170986452221622005096953022156113988298329659057576662558884509027e-41
** Starting computation of basis transformations **
  Block 14 of size 1 x 1
  Block 3 of size 1 x 1
  Block 17 of size 1 x 1
  Block 6 of size 1 x 1
  Block 9 of size 1 x 1
  Block 12 of size 1 x 1
    Block 12 has 1 kernel vectors. The maximum numerator and denominator are 1 and 1
    After reduction, the maximum number of the basis transformation matrix is 1
  Block 1 of size 1 x 1
  Block 15 of size 1 x 1
  Block 4 of size 1 x 1
  Block 18 of size 1 x 1
  Block 0 of size 1 x 1
    Block 0 has 1 kernel vectors. The maximum numerator and denominator are 1 and 1
    After reduction, the maximum number of the basis transformation matrix is 1
  Block 7 of size 1 x 1
  Block 10 of size 1 x 1
  Block 13 of size 1 x 1
  Block 2 of size 1 x 1
  Block 16 of size 1 x 1
  Block 5 of size 1 x 1
  Block 8 of size 1 x 1
  Block 11 of size 1 x 1
  Block B of size 9 x 9
    Block B has 6 kernel vectors. The maximum numerator and denominator are 18 and 2
    After reduction, the maximum number of the basis transformation matrix is 10
  Block A of size 10 x 10
    Block A has 8 kernel vectors. The maximum numerator and denominator are 12 and 1
    After reduction, the maximum number of the basis transformation matrix is 1
** Finished computation of basis transformations (0.009764675s) **
** Transforming the problem and the solution ** (0.0020947229999999997s)
** Projection the solution into the affine space **
  Reducing the system from 26 columns to 26 columns
  Constructing the linear system... (0.241551298s)
  Computing an approximate solution in the extension field... (0.003351887s)
  Preprocessing to get an integer system... (0.000370764s)
  Finding the pivots of A using RREF mod p... (0.000590426 0.000460973 s)
  Solving the system of size 38 x 40 using the pseudoinverse... 0.001962065s
** Finished projection into affine space (0.249299457s) **
** Checking feasibility **
The slacks are satisfied (checked or ensured by solving the system)
Checking sdp constraints
 done (0.017198887)</code></pre><p>This is recommended especially for larger polynomial programs.</p><h2 id="Getting-an-exact-feasible-solution-close-to-the-optimum"><a class="docs-heading-anchor" href="#Getting-an-exact-feasible-solution-close-to-the-optimum">Getting an exact feasible solution close to the optimum</a><a id="Getting-an-exact-feasible-solution-close-to-the-optimum-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-an-exact-feasible-solution-close-to-the-optimum" title="Permalink"></a></h2><p>To modify the code to find an exact strictly feasible solution, we change the code for the objective to the following:</p><pre><code class="language-julia hljs">   if isnothing(obj)
      objective = Objective(1, Dict(k =&gt; [1;;] for k=0:2d), Dict())
   else
      objective = Objective(0, Dict(), Dict()) 
      push!(constraints, Constraint(obj-1, Dict(k =&gt; [1;;] for k=0:2d), Dict()))
   end</code></pre><p>where the function signature is now given by</p><pre><code class="language-julia hljs">function delsarte_exact(n, d, costheta; obj=nothing, FF=QQ, g=1, eps=1e-40)</code></pre><p>That is, it takes an extra argument <code>obj</code>. When <code>obj</code> is set to a numerical value, this adds the constraint that the objective should be equal to <code>obj</code>. Then the exact solution can be found as follows.</p><pre><code class="language-julia hljs">d = 10
# find the objective
obj_initial, problem_initial, _, _ = delsarte_exact(3, d, 1//2)
# find a strictly feasible solution with a slightly larger objective
obj = obj_initial + 1e-6
_, problem, dualsol, primalsol = delsarte_exact(3, d, 1//2, obj=rationalize(obj))
# round the solution
successfull, exactprimalsol = exact_solution(problem, dualsol, primalsol)
Float64(objvalue(problem_initial, exactprimalsol)), obj_initial</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(13.158315347390305, 13.15831434739030571916973180897335312215428963933937637688746103338185352071954)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../clustering/">« Clustering</a><a class="docs-footer-nextpage" href="../../api/">API reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Wednesday 25 February 2026 13:53">Wednesday 25 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
